Why Digital Signature Sizes Vary by Algorithm
==============================================

1. ECDSA P-256 (70-72 bytes)
-----------------------------
ECDSA signatures consist of two integers (r, s), each up to 32 bytes for
the P-256 curve. OpenSSL outputs these in DER (Distinguished Encoding Rules)
format, which is a TLV (Tag-Length-Value) encoding:

    SEQUENCE { INTEGER r, INTEGER s }

DER's INTEGER encoding requires a leading 0x00 byte whenever the most
significant bit of the value is set (to distinguish it from a negative
number). Since r and s are random values, each has roughly a 50% chance of
needing this extra byte. This produces four possible lengths:

    - Neither padded:  2 (seq header) + 2+32 + 2+32 = 70 bytes
    - One padded:      2 + 2+33 + 2+32 = 71 bytes  (or the other way)
    - Both padded:     2 + 2+33 + 2+33 = 72 bytes

This is inherent to DER encoding and is NOT an error.

2. Falcon-512 (~649-666 bytes, varies)
--------------------------------------
Falcon's signature scheme is based on NTRU lattices and uses a compressed
encoding for the signature vector. The compression works by encoding each
coefficient using a variable-length code (similar to Huffman coding), so
the output size depends on the actual coefficient values produced during
each signing operation.

The OQS library allocates the maximum possible buffer (666 bytes for
Falcon-512) but the actual signature returned by OQS_SIG_sign() can be
shorter. This is a fundamental property of the Falcon algorithm, not a bug.

3. Dilithium-2 (always 2420 bytes)
----------------------------------
Dilithium uses a fixed-size encoding for its signatures. Every signature
is exactly 2420 bytes for security level 2. If you observe varying sizes
for Dilithium, that would indicate a bug in the code (not in the algorithm).

Summary
-------
Variable signature sizes for ECDSA and Falcon are expected behavior, produced
by the underlying mathematical and encoding properties of each algorithm.
Only Dilithium guarantees a fixed signature size.
